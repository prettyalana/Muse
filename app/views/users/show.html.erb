<h1><%= @user.username %>'s profile</h1>
<div class="profile-info">
  <%= image_tag @user.image, class: "profile-picture"%>
  <%= @user.bio %>,
  <%= @user.name%>,
  <%= @user.location %>
</div>

<h1 class="page-header">
  <%if @user.buyer? %>
    <%= @user.username %>'s listings
  <% else %>
    <%= @user.username%>'s offers
  <% end %>
</h1>

<div class="card-container">
  <%if @user.buyer? %>
    <% @user.listings.each do |listing|%>
      <div class="card">
        <h5 class="card-title">
          <div class="left-side">
            <%= image_tag listing.buyer.image, class:"profile-picture" %>
            <%= link_to listing.buyer.username, user_path(listing.buyer.username) %>
          </div>
          <div class="right-side">
            <%= link_to edit_listing_path(listing) do %>
              <i class="fa-solid fa-ellipsis"></i>
            <% end %>
            
            <%= form_with(model: listing) do |form| %>
                <%= form.hidden_field :purchased, value: "true"%>


              <div>
                <%= form.submit "Purchased" %>
              </div>
            <% end %>


          </div>
        </h5>
        <%= image_tag listing.image, class: "card-img-top" %>
        <div class="card-body">
          <p class="card-text"><%= listing.caption %></p>

          <%if @user.seller?%>
            <%= link_to new_message_path do %>
              <i class="fa-regular fa-message"></i>
            <% end %>
          <% end %>
        </div>
      </div>
    <% end %>
  <% else %>
    <% if @user.seller?%>
      <% @user.sent_offers.each do |offer|%>
        <div class="card">
          <h5 class="card-title">
            <%= offer.seller.image %>
            <%= offer.seller.username %></h5>
          <%= image_tag offer.image, class: "card-img-top" %>
          <div class="card-body">
            <p class="card-text"><%= offer.description %></p>
          </div>
        </div>
      <% end %>
    <% end %>
  <% end %>
</div>
