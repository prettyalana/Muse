<!DOCTYPE html>
<html>
  <head>
    <title>Muse</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= render partial: "shared/cdn_assets" %>

    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>

    <link rel="icon" href="/assets/favicon-59094402c02c729ac52b081282620c3b4d2857dd676a10fc2ce8fd6febc07900.ico" type="image/x-icon">
    <link rel="icon" href="/assets/favicon-32x32-52215e185344d410f66522d362431aae6f74cc7bbbd4b290aa12ae2a995bf07b.png" sizes="32x32" type="image/png">
    <link rel="icon" href="/assets/favicon-16x16-9db27a37acc29372875f0114d8903d5d836222220495312698ccd9d3c748372f.png" sizes="16x16" type="image/png">
    <link rel="apple-touch-icon" href="public/assets/apple-touch-icon-f10015ac9f165e13643bd03e8dcaa54d692a6fc3f9239994ad8dcec9378b7a29.png">
    <link rel="icon" href="/assets/android-chrome-192x192-f346ac321a7219f882246c1968caa2ff7cc47c00a1901b5219ebf52cf8aafc20.png" sizes="192x192" type="image png">
    <link rel="icon" href="/assets/android-chrome-512x512-d02210ac9d4c49ba6f25c9dd9473f5bd2c963376a1675fe8a00562bfde679aac.png">


  </head>

  <body>
    <%= render partial: "shared/navbar" %>
    <%= yield %>

    <button id="theme-switch">
      <svg id="light-icon" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px">
        <path d="M480-120q-150 0-255-105T120-480q0-150 105-255t255-105q14 0 27.5 1t26.5 3q-41 29-65.5 75.5T444-660q0 90 63 153t153 63q55 0 101-24.5t75-65.5q2 13 3 26.5t1 27.5q0 150-105 255T480-120Z"/>
      </svg>
      <svg id="dark-icon" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px">
        <path d="M480-280q-83 0-141.5-58.5T280-480q0-83 58.5-141.5T480-680q83 0 141.5 58.5T680-480q0 83-58.5 141.5T480-280ZM200-440H40v-80h160v80Zm720 0H760v-80h160v80ZM440-760v-160h80v160h-80Zm0 720v-160h80v160h-80ZM256-650l-101-97 57-59 96 100-52 56Zm492 496-97-101 53-55 101 97-57 59Zm-98-550 97-101 59 57-100 96-56-52ZM154-212l101-97 55 53-97 101-59-57Z"/>
      </svg>
    </button>

    <script>
      document.addEventListener('load', function() {
        let darkmode = localStorage.getItem('darkmode');
        const themeSwitch = document.getElementById('theme-switch');

        const enableDarkmode = () => {
          document.body.classList.add('darkmode');
          localStorage.setItem('darkmode', 'active');
        };

        const disableDarkmode = () => {
          document.body.classList.remove('darkmode');
          localStorage.setItem('darkmode', null);
        };

        if (darkmode === "active") enableDarkmode();

        themeSwitch.addEventListener("click", () => {
          darkmode = localStorage.getItem('darkmode');
          if (darkmode !== "active") {
            enableDarkmode();
          } else {
            disableDarkmode();
          }
        });
      });

      document.addEventListener('turbo:load', function() {
        let darkmode = localStorage.getItem('darkmode');
        const themeSwitch = document.getElementById('theme-switch');

        const enableDarkmode = () => {
          document.body.classList.add('darkmode');
          localStorage.setItem('darkmode', 'active');
        };

        const disableDarkmode = () => {
          document.body.classList.remove('darkmode');
          localStorage.setItem('darkmode', null);
        };

        if (darkmode === "active") enableDarkmode();

        themeSwitch.addEventListener("click", () => {
          darkmode = localStorage.getItem('darkmode');
          if (darkmode !== "active") {
            enableDarkmode();
          } else {
            disableDarkmode();
          }
        });
      });
    </script>

  </body>
</html>
